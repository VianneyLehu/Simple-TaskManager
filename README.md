TODO: 
- refactor code
- add some debugging
